package bedrock_rocket_bot

import (
	"net"
)

// Login отправляет пакет авторизации
func Login(conn net.Conn, username string) error {
	buf := make([]byte, 0)
	WriteUint8(&buf, LoginPacketID)

	// Protocol Version (489 для 1.20.70)
	WriteUint32(&buf, 489)

	// Client Data (заглушка)
	WriteUint64(&buf, 0) // Client ID
	WriteString(&buf, username)
	WriteString(&buf, "") // Skin ID
	WriteString(&buf, "") // Language

	frame := NewFrame(buf)
	packet := frame.Serialize()

	_, err := conn.Write(packet)
	return err
}

// NewTextPacket создаёт пакет чата
func NewTextPacket(message string) []byte {
	buf := make([]byte, 0)
	WriteUint8(&buf, TextPacketID)
	WriteUint8(&buf, 0x01) // Chat type
	WriteString(&buf, "")  // Sender
	WriteString(&buf, message)
	return buf
}

